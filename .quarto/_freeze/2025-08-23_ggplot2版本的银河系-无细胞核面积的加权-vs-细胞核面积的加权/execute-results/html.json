{
  "hash": "0fa522b6eb4a294ac923112d022a5ac4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: ggplot2â€œé“¶æ²³ç³»â€åŠ æƒæœ‰æ— \nsubtitle: ggplot2ç‰ˆæœ¬çš„â€œé“¶æ²³ç³»â€ï¼šæ— ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒ vs. ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒ\ndate: 2025-08-23\ntoc-depth: 4\ntoc-expand: true\nlang: en\n---\n\nåœ¨2025-07-29ï¼Œæˆ‘ä»¬å±•ç¤ºè¿‡H&Eèµ·æºç‰ˆæœ¬çš„â€œé“¶æ²³ç³»â€ï¼ˆ[QuPathï¼šâ€œé“¶æ²³ç³»â€èµ·æºäºH&E](2025-07-29_é“¶æ²³ç³»èµ·æºäºHE.qmd)ï¼‰ã€‚åœ¨2025-08-12ï¼Œæˆ‘ä»¬é€šè¿‡Rçš„ggplot2æ¥å±•ç¤ºè¯¥â€œé“¶æ²³ç³»â€ï¼ˆ[Rï¼šggplot2ç­‰é«˜çº¿å›¾ç‰ˆæœ¬çš„â€œé“¶æ²³ç³»â€](2025-08-12_ggplot2ç­‰é«˜çº¿å›¾ç‰ˆæœ¬çš„é“¶æ²³ç³».qmd)ï¼‰ã€‚åœ¨2025-08-15ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥è®¡ç®—ç‰¹å®šç­‰é«˜çº¿çš„é¢ç§¯[Rï¼šggplot2ç‰ˆæœ¬çš„â€œé“¶æ²³ç³»â€ï¼Œå¹¶è®¡ç®—ç‰¹å®šç­‰é«˜çº¿çš„é¢ç§¯](2025-08-15_ggplot2ç‰ˆæœ¬çš„é“¶æ²³ç³»-å¹¶è®¡ç®—ç‰¹å®šç­‰é«˜çº¿çš„é¢ç§¯.qmd)ï¼‰ã€‚åœ¨2025-08-21ï¼Œæˆ‘ä»¬å°†ç­‰é«˜çº¿å±•ç¤ºåœ¨åŸå§‹H&Eå›¾ç‰‡ä¸Šï¼ˆ[Rï¼šggplot2ç‰ˆæœ¬çš„â€œé“¶æ²³ç³»â€ï¼Œå¹¶å°†ç­‰é«˜çº¿å±•ç¤ºåœ¨H&Eå›¾ä¸Š](2025-08-21_ggplot2ç‰ˆæœ¬çš„é“¶æ²³ç³»-å¹¶å°†ç­‰é«˜çº¿å±•ç¤ºåœ¨HEå›¾ä¸Š.qmd)ï¼‰ã€‚\n\nè¿™æ¬¡ï¼Œæˆ‘ä»¬é€šè¿‡ggplot2å±•ç¤ºè¯¥â€œé“¶æ²³ç³»â€ï¼Œä¸”æ¯”è¾ƒæœ‰æ— ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒã€‚\n\n## 1. Load packages and read data/åŠ è½½åŒ…å’Œè¯»å–æ•°æ®\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse) # for data manipulation and visualization\nlibrary(RColorBrewer) # for color palettes\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read the table\ntxt_file <- \"raw_data/2025-08-12_QuPath_InstanSeg.txt\" # specify the path to the text file\ndf <- txt_file |> read_delim(delim = \"\\t\", col_names = TRUE, show_col_types = FALSE) # read the text file as a data frame\ntxt_file |> rm() # remove the txt_file variable to free up memory\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |> \n    dplyr::select(`Centroid X Âµm`, `Centroid Y Âµm`, `Area Âµm^2`) # select the columns specifying the coordinates and area of nuclei\ndf |> head() # display the first few rows of the data frame\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 Ã— 3\n  `Centroid X Âµm` `Centroid Y Âµm` `Area Âµm^2`\n            <dbl>           <dbl>       <dbl>\n1            131.            88.4        29.2\n2            118.            90.2        55.5\n3            169.            90.9        55.5\n4            179.            95.0        61  \n5            230.            96.5        69.8\n6            119.            96.8        53.8\n```\n\n\n:::\n:::\n\n\n## 2. å¢åŠ ä¸€ä¸ªâ€œrandom_colorâ€åˆ—ï¼Œç”¨äºæ¯ä¸ªç»†èƒæ ¸é¢œè‰²çš„éšæœºåˆ†é…\n\n\n::: {.cell}\n\n```{.r .cell-code}\npalette <- brewer.pal(8, \"Set2\") # get a color palette\n\ndf <- df |> \n  mutate(Random_color = sample(palette, nrow(df), replace = TRUE)) # add a random color column\n\ndf |> head() # Display the first six rows of the updated data frame\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 Ã— 4\n  `Centroid X Âµm` `Centroid Y Âµm` `Area Âµm^2` Random_color\n            <dbl>           <dbl>       <dbl> <chr>       \n1            131.            88.4        29.2 #FC8D62     \n2            118.            90.2        55.5 #E78AC3     \n3            169.            90.9        55.5 #E5C494     \n4            179.            95.0        61   #B3B3B3     \n5            230.            96.5        69.8 #FC8D62     \n6            119.            96.8        53.8 #8DA0CB     \n```\n\n\n:::\n:::\n\n\n## 3. Plot the nuclei as points and add contour lines/ç»˜åˆ¶æ— ç»†èƒæ ¸é¢ç§¯åŠ æƒçš„åˆ†å¸ƒå›¾å’Œæœ‰ç»†èƒæ ¸é¢ç§¯åŠ æƒçš„åˆ†å¸ƒå›¾\n\n### 3.1 Without weighted area/æ— ç»†èƒæ ¸é¢ç§¯åŠ æƒ\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnuclei_unweighted <- ggplot(df, aes(x = `Centroid X Âµm`, y = `Centroid Y Âµm`)) +\n  geom_point(aes(color = Random_color)) + # scatter plot\n  scale_x_continuous(limits = c(0, 1000)) + # set x limits\n  scale_y_continuous(limits = c(0, 900)) + # set y limits\n  theme_classic() # apply classic theme\n\nnuclei_unweighted\n```\n\n::: {.cell-output-display}\n![](2025-08-23_ggplot2ç‰ˆæœ¬çš„é“¶æ²³ç³»-æ— ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒ-vs-ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒ_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"images/2025-08-23_without-weighted-area.png\", width = 8, height = 6, dpi = 300)\n```\n:::\n\n\n### 3.2 With weighted area/æœ‰ç»†èƒæ ¸é¢ç§¯åŠ æƒ\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnuclei_weighted <- ggplot(df, aes(x = `Centroid X Âµm`, y = `Centroid Y Âµm`)) +\n  geom_point(aes(color = Random_color, size = `Area Âµm^2`), alpha = 1/2) + # scatter plot\n  scale_size_area(\"Area\\n(Âµm^2)\", breaks = c(5, 10, 20, 40, 80, 120, 160)) + # set size scale\n  scale_x_continuous(limits = c(0, 1000)) + # set x limits\n  scale_y_continuous(limits = c(0, 900)) + # set y limits\n  theme_classic() # apply classic theme\n\nnuclei_weighted\n```\n\n::: {.cell-output-display}\n![](2025-08-23_ggplot2ç‰ˆæœ¬çš„é“¶æ²³ç³»-æ— ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒ-vs-ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒ_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## 4. â€œé“¶æ²³ç³»â€çš„èµ·æº\n\n<img src=\"images/he_low.png\" style=\"width: 100%; height: auto\">\n\n[ç»™æˆ‘ä¹°æ¯èŒ¶ğŸµ](ç»™æˆ‘ä¹°æ¯èŒ¶.qmd)",
    "supporting": [
      "2025-08-23_ggplot2ç‰ˆæœ¬çš„é“¶æ²³ç³»-æ— ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒ-vs-ç»†èƒæ ¸é¢ç§¯çš„åŠ æƒ_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}